\pred ->
  let fn s =
    match s with 
        a ++ as -> 
          (let rest =
            fn as;

          if (pred a)
          then
            a ++ rest
          else
            rest)
      | _ -> 
          "";

  \str -> fn str (\a -> a == "o") "woo"